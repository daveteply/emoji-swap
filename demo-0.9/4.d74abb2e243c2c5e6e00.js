(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{ekgB:function(e,t,i){"use strict";i.r(t),i.d(t,"GameModule",function(){return Y});var a=i("ofXK"),r=i("tyNb"),n=i("fXoL"),o=i("bTqV"),s=i("XNiG");let l=(()=>{class e{WithinGrid(e,t,i){var a,r;const n=null===(a=null==i?void 0:i.grid)||void 0===a?void 0:a.length,o=null===(r=null==i?void 0:i.grid[0])||void 0===r?void 0:r.length;return e>-1&&t>-1&&e<n&&t<o}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=n.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var c=function(e){return e[e.Left=2]="Left",e[e.Right=4]="Right",e[e.Up=8]="Up",e[e.Down=16]="Down",e}({}),m=function(e){return e[e.LocateAdjacentTile=0]="LocateAdjacentTile",e[e.ApplyDirectionalAnimation=1]="ApplyDirectionalAnimation",e[e.Swap=2]="Swap",e[e.SwapBack=3]="SwapBack",e[e.Shutter=4]="Shutter",e[e.ShowHint=5]="ShowHint",e}({});let d=(()=>{class e{constructor(e){this.gameUtilityService=e,this.gameInteractionStateSource=new s.a,this.gameInteractionState$=this.gameInteractionStateSource.asObservable(),this.isSwapBack=!1}DoStep(e){this.gameInteractionStateSource.next(e)}TileSwiped(e){this.playerTile=e,this.adjacentTile={},this.gameInteractionStateSource.next(m.LocateAdjacentTile)}LocateAdjacentTile(e){let t=this.playerTile.tile.rowInx,i=this.playerTile.tile.colInx;if(1!==this.playerTile.direction){switch(this.playerTile.direction){case c.Up:t--;break;case c.Right:i++;break;case c.Down:t++;break;case c.Left:i--}if(this.gameUtilityService.WithinGrid(t,i,e))return this.adjacentTile=e.grid[t][i],!0}return e.grid[this.playerTile.tile.rowInx][this.playerTile.tile.colInx].animateShutter=!1,this.gameInteractionStateSource.next(m.Shutter),!1}SetDirectionalAnimationClass(e){switch(this.playerTile.direction){case c.Up:e.grid[this.playerTile.tile.rowInx][this.playerTile.tile.colInx].animateSlideUp=!0,e.grid[this.adjacentTile.rowInx][this.adjacentTile.colInx].animateSlideDown=!0;break;case c.Right:e.grid[this.playerTile.tile.rowInx][this.playerTile.tile.colInx].animateSlideRight=!0,e.grid[this.adjacentTile.rowInx][this.adjacentTile.colInx].animateSlideLeft=!0;break;case c.Down:e.grid[this.playerTile.tile.rowInx][this.playerTile.tile.colInx].animateSlideDown=!0,e.grid[this.adjacentTile.rowInx][this.adjacentTile.colInx].animateSlideUp=!0;break;case c.Left:e.grid[this.playerTile.tile.rowInx][this.playerTile.tile.colInx].animateSlideLeft=!0,e.grid[this.adjacentTile.rowInx][this.adjacentTile.colInx].animateSlideRight=!0}this.gameInteractionStateSource.next(m.Swap)}Swap(e){const t=Object.assign({},e.grid[this.playerTile.tile.rowInx][this.playerTile.tile.colInx]),i=Object.assign({},e.grid[this.adjacentTile.rowInx][this.adjacentTile.colInx]);e.grid[this.playerTile.tile.rowInx][this.playerTile.tile.colInx]=i,e.grid[this.adjacentTile.rowInx][this.adjacentTile.colInx]=t}SwapBack(){this.isSwapBack=!this.isSwapBack,this.isSwapBack&&this.gameInteractionStateSource.next(m.LocateAdjacentTile)}Shutter(e){e.grid[this.playerTile.tile.rowInx][this.playerTile.tile.colInx].animateShutter=!0}ApplyPotentials(e,t,i){if(e&&(null==t?void 0:t.length))if(i){const i=t[Math.floor(Math.random()*t.length)];this.applyPotentialClass(i,e)}else for(const a of t)this.applyPotentialClass(a,e)}applyPotentialClass(e,t){for(const i of e)t.grid[i.rowInx][i.colInx].potential=!0}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(l))},e.\u0275prov=n.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var h=i("D0XW"),p=i("7o/Q"),g=i("WMd4");function b(e,t=h.a){var i;const a=(i=e)instanceof Date&&!isNaN(+i)?+e-t.now():Math.abs(e);return e=>e.lift(new u(a,t))}class u{constructor(e,t){this.delay=e,this.scheduler=t}call(e,t){return t.subscribe(new f(e,this.delay,this.scheduler))}}class f extends p.a{constructor(e,t,i){super(e),this.delay=t,this.scheduler=i,this.queue=[],this.active=!1,this.errored=!1}static dispatch(e){const t=e.source,i=t.queue,a=e.scheduler,r=e.destination;for(;i.length>0&&i[0].time-a.now()<=0;)i.shift().notification.observe(r);if(i.length>0){const t=Math.max(0,i[0].time-a.now());this.schedule(e,t)}else this.unsubscribe(),t.active=!1}_schedule(e){this.active=!0,this.destination.add(e.schedule(f.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))}scheduleNotification(e){if(!0===this.errored)return;const t=this.scheduler,i=new v(t.now()+this.delay,e);this.queue.push(i),!1===this.active&&this._schedule(t)}_next(e){this.scheduleNotification(g.a.createNext(e))}_error(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()}_complete(){this.scheduleNotification(g.a.createComplete()),this.unsubscribe()}}class v{constructor(e,t){this.time=e,this.notification=t}}var S=i("1G5W"),y=function(e){return e[e.LockBoard=0]="LockBoard",e[e.FindMatches=1]="FindMatches",e[e.RemoveMatchSet=2]="RemoveMatchSet",e[e.ApplyScoring=3]="ApplyScoring",e[e.UnlockBoard=4]="UnlockBoard",e}({});let w=(()=>{class e{constructor(){this.gameLoopStateSource=new s.a,this.gameLoopState$=this.gameLoopStateSource.asObservable()}DoStep(e){this.gameLoopStateSource.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=n.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var _=i("9oZ7"),x=i("jHbz"),I=function(e){return e[e.SetToRemove=0]="SetToRemove",e[e.NextTile=1]="NextTile",e[e.ApplyRemoveClass=2]="ApplyRemoveClass",e[e.ApplyDropClass=3]="ApplyDropClass",e[e.Shift=4]="Shift",e[e.Complete=5]="Complete",e}({});let M=(()=>{class e{constructor(e){this.audioService=e,this.tileRemoveStateSource=new s.a,this.tilesToRemove=[],this.tileRemoveState$=this.tileRemoveStateSource.asObservable()}StartTileDeletion(e){this.tilesToRemove=e,this.tileRemoveStateSource.next(I.SetToRemove)}SetToRemove(e){this.tilesToRemove.forEach(t=>{e.grid[t.rowInx][t.colInx].toRemove=!0}),this.tileRemoveStateSource.next(I.NextTile)}NextTile(e){this.tilesToRemove.length?(this.currentTile=this.tilesToRemove.shift(),e.colInx=this.currentTile.colInx,this.newTile=e,this.tileRemoveStateSource.next(I.ApplyRemoveClass)):this.tileRemoveStateSource.next(I.Complete)}ApplyRemoveClass(e){e.grid[this.currentTile.rowInx][this.currentTile.colInx].animateRemove=!0,this.tileRemoveStateSource.next(I.ApplyDropClass),this.audioService.PlayAudio(_.b.TileRemove)}ApplyDropClass(e){let t=this.currentTile.rowInx;for(;t>0;)t--,e.grid[t][this.currentTile.colInx].animateSlideDown=!0;this.tileRemoveStateSource.next(I.Shift)}Shift(e){let t=this.currentTile.rowInx;const i=this.currentTile.colInx;for(;t>0;){t--;const a=Object.assign({},e.grid[t][i]);a.rowInx=t+1,a.animateSlideDown=!1,e.grid[t+1][i]=a}e.grid[0][i]=this.newTile,this.tileRemoveStateSource.next(I.NextTile)}debugColumn(e,t){for(let i=0;i<t.grid.length;i++)console.log("    ",i,t.grid[i][e])}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(x.a))},e.\u0275prov=n.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const k={list:[{level:1,title:"Fun Emojis!",emojis:[{code:"1F60E",title:"smiling face with sunglasses"},{code:"1F63A",title:"grinning cat"},{code:"1F43A",title:"wolf"},{code:"1F42C",title:"dolphin"},{code:"1F3E1",title:"house with garden"},{code:"1F9C7",title:"waffle"}]},{level:2,title:"Ground Transport",emojis:[{code:"1F694",title:"oncoming police car"},{code:"1F699",title:"sport utility vehicle"},{code:"1F68D",title:"oncoming bus"},{code:"26FD",title:"fuel pump"},{code:"1F6A7",title:"construction"},{code:"1F6A5",title:"horizontal traffic light"}]},{level:3,title:"Sky",emojis:[{code:"1F319",title:"crescent moon"},{code:"1F31E",title:"sun with face"},{code:"1F320",title:"shooting star"},{code:"1FA90",title:"ringed planet"},{code:"1F308",title:"rainbow"},{code:"1F30C",title:"milky way"}]}]};var T=function(e){return e[e.N=0]="N",e[e.NE=1]="NE",e[e.E=2]="E",e[e.SE=3]="SE",e[e.S=4]="S",e[e.SW=5]="SW",e[e.W=6]="W",e[e.NW=7]="NW",e}({});const O=[T.N,T.E,T.S,T.W],C=[T.N,T.NE,T.E,T.SE,T.S,T.SW,T.W,T.NW];let A=(()=>{class e{constructor(e){this.gameUtilityService=e,this.candidateMatches=new Array,this.matchSets=[],this.potentialMatchSets=[]}get currentMatchSets(){return this.matchSets}get currentPotentialMatches(){return this.potentialMatchSets}CreateGame(e,t,i){const a={grid:[]};for(let r=0;r<e;r++){a.grid[r]=new Array;for(let e=0;e<t;e++){const t=this.NewTile(r,e,i);a.grid[r][e]=t}}return a}NewTile(e,t,i){var a;const r=k.list.find(e=>e.level===i),n=null==r?void 0:r.emojis[Math.floor(Math.random()*(null===(a=null==r?void 0:r.emojis)||void 0===a?void 0:a.length))];return Object.assign({colInx:t,rowInx:e,html:`&#x${null==n?void 0:n.code};`,score:0},n)}ReIndexGrid(e){var t;null===(t=null==e?void 0:e.grid)||void 0===t||t.forEach((t,i)=>{t.forEach((t,a)=>{e.grid[i][a].colInx=a,e.grid[i][a].rowInx=i,e.grid[i][a].matched=!1,e.grid[i][a].potential=!1,e.grid[i][a].score=0,e.grid[i][a].animateSlideUp=!1,e.grid[i][a].animateSlideRight=!1,e.grid[i][a].animateSlideDown=!1,e.grid[i][a].animateSlideLeft=!1,e.grid[i][a].animateShutter=!1,e.grid[i][a].potential=!1})})}ApplyScoring(e,t,i){for(const a of t){const r=e.grid[a.rowInx][a.colInx].score*i;e.grid[a.rowInx][a.colInx].score=r?r*t.length:t.length}}TallyScore(e){let t=0;return null==e||e.grid.forEach(e=>e.forEach(e=>{t+=e.score})),t}FindMatchesAndPotentials(e){var t;this.candidateMatches=[],this.matchSets=[],this.potentialMatchSets=[],null===(t=null==e?void 0:e.grid)||void 0===t||t.forEach(t=>{t.forEach(t=>{O.forEach(i=>{this.candidateMatches=[Object.assign({},t)],this.directionalSearch(i,t,e),this.candidateMatches.length>=3&&(this.candidateMatches.forEach(t=>{e.grid[t.rowInx][t.colInx].matched=!0}),this.candidateMatches.every(e=>e.matched)||this.matchSets.push([...this.candidateMatches]))}),this.potentialSearchStaggered(t,e)})})}directionalSearch(e,t,i){let a=t.rowInx,r=t.colInx;switch(e){case T.N:a=t.rowInx-1;break;case T.E:r=t.colInx+1;break;case T.S:a=t.rowInx+1;break;case T.W:r=t.colInx-1}if(!this.gameUtilityService.WithinGrid(a,r,i))return;const n=i.grid[a][r];if(n.code===t.code)this.candidateMatches.push(Object.assign({},n)),this.directionalSearch(e,n,i);else if(2===this.candidateMatches.length)return this.potentialSearch(t,i),void this.potentialExtended(e,t,i)}potentialSearch(e,t){let i=0,a=0;for(const r of C){switch(r){case T.N:i=e.rowInx-1;break;case T.NE:i=e.rowInx-1,a=e.colInx+1;break;case T.E:a=e.colInx+1;break;case T.SE:i=e.rowInx+1,a=e.colInx+1;break;case T.S:i=e.rowInx+1;break;case T.SW:i=e.rowInx+1,a=e.colInx-1;break;case T.W:a=e.colInx-1;break;case T.NW:i=e.rowInx-1,a=e.colInx-1}if(this.gameUtilityService.WithinGrid(i,a,t)){const r=t.grid[i][a],n=this.candidateMatches[0];if(r&&r.rowInx!==n.rowInx&&r.colInx!==n.colInx&&r.code===e.code)return void this.potentialMatchSets.push([...this.candidateMatches,r])}}}potentialExtended(e,t,i){let a=t.rowInx,r=t.colInx;switch(e){case T.N:a=t.rowInx-2;break;case T.E:r=t.colInx+2;break;case T.S:a=t.rowInx+2;break;case T.W:r=t.colInx-2}if(this.gameUtilityService.WithinGrid(a,r,i)){const e=i.grid[a][r];this.candidateMatches.every(t=>t.code===e.code)&&this.potentialMatchSets.push([...this.candidateMatches,e])}}potentialSearchStaggered(e,t){var i;const a=new Array;let r=0,n=0;if(O.forEach(i=>{switch(r=e.rowInx,n=e.colInx,i){case T.N:r=e.rowInx-1;break;case T.E:n=e.colInx+1;break;case T.S:r=e.rowInx+1;break;case T.W:n=e.colInx-1}this.gameUtilityService.WithinGrid(r,n,t)&&a.push(t.grid[r][n])}),a.length>=3)for(let o=0;o<a.length;o++){const e=null===(i=a[o])||void 0===i?void 0:i.code,t=a.filter(t=>(null==t?void 0:t.code)===e);if(t.length>=3)return void this.potentialMatchSets.push(t)}}}return e.\u0275fac=function(t){return new(t||e)(n.Sb(l))},e.\u0275prov=n.Hb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var P=i("FKr1"),R=i("8LU1"),N=i("R1ws"),L=i("quSY"),E=i("xgIS"),D=i("pLZG");const B=["primaryValueBar"];class j{constructor(e){this._elementRef=e}}const U=Object(P.d)(j,"primary"),F=new n.q("mat-progress-bar-location",{providedIn:"root",factory:function(){const e=Object(n.V)(a.d),t=e?e.location:null;return{getPathname:()=>t?t.pathname+t.search:""}}});let W=0,V=(()=>{class e extends U{constructor(e,t,i,a){super(e),this._elementRef=e,this._ngZone=t,this._animationMode=i,this._isNoopAnimation=!1,this._value=0,this._bufferValue=0,this.animationEnd=new n.n,this._animationEndSubscription=L.a.EMPTY,this.mode="determinate",this.progressbarId="mat-progress-bar-"+W++;const r=a?a.getPathname().split("#")[0]:"";this._rectangleFillValue=`url('${r}#${this.progressbarId}')`,this._isNoopAnimation="NoopAnimations"===i}get value(){return this._value}set value(e){this._value=G(Object(R.e)(e)||0)}get bufferValue(){return this._bufferValue}set bufferValue(e){this._bufferValue=G(e||0)}_primaryTransform(){return{transform:`scale3d(${this.value/100}, 1, 1)`}}_bufferTransform(){return"buffer"===this.mode?{transform:`scale3d(${this.bufferValue/100}, 1, 1)`}:null}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{const e=this._primaryValueBar.nativeElement;this._animationEndSubscription=Object(E.a)(e,"transitionend").pipe(Object(D.a)(t=>t.target===e)).subscribe(()=>{"determinate"!==this.mode&&"buffer"!==this.mode||this._ngZone.run(()=>this.animationEnd.next({value:this.value}))})})}ngOnDestroy(){this._animationEndSubscription.unsubscribe()}}return e.\u0275fac=function(t){return new(t||e)(n.Lb(n.l),n.Lb(n.A),n.Lb(N.a,8),n.Lb(F,8))},e.\u0275cmp=n.Fb({type:e,selectors:[["mat-progress-bar"]],viewQuery:function(e,t){if(1&e&&n.uc(B,!0),2&e){let e;n.gc(e=n.Wb())&&(t._primaryValueBar=e.first)}},hostAttrs:["role","progressbar","aria-valuemin","0","aria-valuemax","100",1,"mat-progress-bar"],hostVars:4,hostBindings:function(e,t){2&e&&(n.Cb("aria-valuenow","indeterminate"===t.mode||"query"===t.mode?null:t.value)("mode",t.mode),n.Db("_mat-animation-noopable",t._isNoopAnimation))},inputs:{color:"color",mode:"mode",value:"value",bufferValue:"bufferValue"},outputs:{animationEnd:"animationEnd"},exportAs:["matProgressBar"],features:[n.yb],decls:9,vars:4,consts:[["width","100%","height","4","focusable","false",1,"mat-progress-bar-background","mat-progress-bar-element"],["x","4","y","0","width","8","height","4","patternUnits","userSpaceOnUse",3,"id"],["cx","2","cy","2","r","2"],["width","100%","height","100%"],[1,"mat-progress-bar-buffer","mat-progress-bar-element",3,"ngStyle"],[1,"mat-progress-bar-primary","mat-progress-bar-fill","mat-progress-bar-element",3,"ngStyle"],["primaryValueBar",""],[1,"mat-progress-bar-secondary","mat-progress-bar-fill","mat-progress-bar-element"]],template:function(e,t){1&e&&(n.Yb(),n.Ob(0,"svg",0),n.Ob(1,"defs"),n.Ob(2,"pattern",1),n.Mb(3,"circle",2),n.Nb(),n.Nb(),n.Mb(4,"rect",3),n.Nb(),n.Xb(),n.Mb(5,"div",4),n.Mb(6,"div",5,6),n.Mb(8,"div",7)),2&e&&(n.Bb(2),n.fc("id",t.progressbarId),n.Bb(2),n.Cb("fill",t._rectangleFillValue),n.Bb(1),n.fc("ngStyle",t._bufferTransform()),n.Bb(1),n.fc("ngStyle",t._primaryTransform()))},directives:[a.m],styles:['.mat-progress-bar{display:block;height:4px;overflow:hidden;position:relative;transition:opacity 250ms linear;width:100%}._mat-animation-noopable.mat-progress-bar{transition:none;animation:none}.mat-progress-bar .mat-progress-bar-element,.mat-progress-bar .mat-progress-bar-fill::after{height:100%;position:absolute;width:100%}.mat-progress-bar .mat-progress-bar-background{width:calc(100% + 10px)}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-background{display:none}.mat-progress-bar .mat-progress-bar-buffer{transform-origin:top left;transition:transform 250ms ease}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-buffer{border-top:solid 5px;opacity:.5}.mat-progress-bar .mat-progress-bar-secondary{display:none}.mat-progress-bar .mat-progress-bar-fill{animation:none;transform-origin:top left;transition:transform 250ms ease}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-fill{border-top:solid 4px}.mat-progress-bar .mat-progress-bar-fill::after{animation:none;content:"";display:inline-block;left:0}.mat-progress-bar[dir=rtl],[dir=rtl] .mat-progress-bar{transform:rotateY(180deg)}.mat-progress-bar[mode=query]{transform:rotateZ(180deg)}.mat-progress-bar[mode=query][dir=rtl],[dir=rtl] .mat-progress-bar[mode=query]{transform:rotateZ(180deg) rotateY(180deg)}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-fill,.mat-progress-bar[mode=query] .mat-progress-bar-fill{transition:none}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary,.mat-progress-bar[mode=query] .mat-progress-bar-primary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-translate 2000ms infinite linear;left:-145.166611%}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-primary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-scale 2000ms infinite linear}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary,.mat-progress-bar[mode=query] .mat-progress-bar-secondary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-translate 2000ms infinite linear;left:-54.888891%;display:block}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-secondary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-scale 2000ms infinite linear}.mat-progress-bar[mode=buffer] .mat-progress-bar-background{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-background-scroll 250ms infinite linear;display:block}.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-buffer,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-background{animation:none;transition-duration:1ms}@keyframes mat-progress-bar-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mat-progress-bar-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mat-progress-bar-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mat-progress-bar-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mat-progress-bar-background-scroll{to{transform:translateX(-8px)}}\n'],encapsulation:2,changeDetection:0}),e})();function G(e,t=0,i=100){return Math.max(t,Math.min(i,e))}let X=(()=>{class e{}return e.\u0275mod=n.Jb({type:e}),e.\u0275inj=n.Ib({factory:function(t){return new(t||e)},imports:[[a.c,P.a],P.a]}),e})(),z=(()=>{class e{constructor(e){this.gameInteractionsService=e}onSwipe(e){this.gameInteractionsService.TileSwiped({tile:this.tile,direction:null==e?void 0:e.direction})}}return e.\u0275fac=function(t){return new(t||e)(n.Lb(d))},e.\u0275cmp=n.Fb({type:e,selectors:[["app-game-board-tile"]],inputs:{tile:"tile",disabled:"disabled"},decls:2,vars:23,consts:[[1,"game-tile",3,"swipe"],[1,"tile-overlay",3,"innerHTML"]],template:function(e,t){1&e&&(n.Ob(0,"div",0),n.Vb("swipe",function(e){return t.onSwipe(e)}),n.Mb(1,"div",1),n.Nb()),2&e&&(n.Db("game-tile__disabled",t.disabled),n.Bb(1),n.Db("tile-overlay__disabled",t.disabled&&!(null!=t.tile&&t.tile.toRemove)&&!(null!=t.tile&&t.tile.animateRemove)&&!(null!=t.tile&&t.tile.animateSlideUp)&&!(null!=t.tile&&t.tile.animateSlideRight)&&!(null!=t.tile&&t.tile.animateSlideDown)&&!(null!=t.tile&&t.tile.animateSlideLeft))("tile-overlay__to-remove",null==t.tile?null:t.tile.toRemove)("tile-overlay__remove",null==t.tile?null:t.tile.animateRemove)("tile-overlay__slide-up",null==t.tile?null:t.tile.animateSlideUp)("tile-overlay__slide-right",null==t.tile?null:t.tile.animateSlideRight)("tile-overlay__slide-down",null==t.tile?null:t.tile.animateSlideDown)("tile-overlay__slide-left",null==t.tile?null:t.tile.animateSlideLeft)("tile-overlay__reset-slide",!(null!=t.tile&&t.tile.animateSlideDown||null!=t.tile&&t.tile.animateSlideUp||null!=t.tile&&t.tile.animateSlideRight||null!=t.tile&&t.tile.animateSlideLeft))("tile-overlay__shutter",null==t.tile?null:t.tile.animateShutter)("tile-overlay__hint",null==t.tile?null:t.tile.potential),n.fc("innerHTML",null==t.tile?null:t.tile.html,n.kc))},styles:[".game-tile[_ngcontent-%COMP%]{width:8em;height:8em;position:relative}.game-tile__disabled[_ngcontent-%COMP%]{pointer-events:none}.game-tile[_ngcontent-%COMP%]   .tile-overlay__slide-down[_ngcontent-%COMP%], .game-tile[_ngcontent-%COMP%]   .tile-overlay__slide-left[_ngcontent-%COMP%], .game-tile[_ngcontent-%COMP%]   .tile-overlay__slide-right[_ngcontent-%COMP%], .game-tile[_ngcontent-%COMP%]   .tile-overlay__slide-up[_ngcontent-%COMP%], .game-tile[_ngcontent-%COMP%]   .tile-slide[_ngcontent-%COMP%]{z-index:1;filter:blur(2px)}.game-tile[_ngcontent-%COMP%]   .tile-overlay[_ngcontent-%COMP%]{position:absolute;width:90%;height:90%;top:0;left:0;font-size:4.5em;display:flex;justify-content:center;align-items:center;border-radius:.1em;background-color:#ddd;transition:margin-left .5s,margin-top .5s}.game-tile[_ngcontent-%COMP%]   .tile-overlay__disabled[_ngcontent-%COMP%]{filter:blur(2px) grayscale(50%) brightness(.7)}.game-tile[_ngcontent-%COMP%]   .tile-overlay__slide-down[_ngcontent-%COMP%]{margin-top:3.3em}.game-tile[_ngcontent-%COMP%]   .tile-overlay__slide-up[_ngcontent-%COMP%]{margin-top:-3.3em}.game-tile[_ngcontent-%COMP%]   .tile-overlay__slide-right[_ngcontent-%COMP%]{margin-left:3.3em}.game-tile[_ngcontent-%COMP%]   .tile-overlay__slide-left[_ngcontent-%COMP%]{margin-left:-3.3em}.game-tile[_ngcontent-%COMP%]   .tile-overlay__reset-slide[_ngcontent-%COMP%]{transition:transform 1s,font-size 1s,opacity 1s;margin-left:0;margin-top:0}.game-tile[_ngcontent-%COMP%]   .tile-overlay__to-remove[_ngcontent-%COMP%]{animation:wobble .5s infinite}.game-tile[_ngcontent-%COMP%]   .tile-overlay__remove[_ngcontent-%COMP%]{animation:remove 1s}.game-tile[_ngcontent-%COMP%]   .tile-overlay__shutter[_ngcontent-%COMP%]{animation:shutter .25s 2}.game-tile[_ngcontent-%COMP%]   .tile-overlay__hint[_ngcontent-%COMP%]{animation:hint .5s}@keyframes remove{0%{font-size:250%}50%{transform:rotate(-365deg);font-size:90%;opacity:0}}@keyframes wobble{0%{transform:rotate(10deg);font-size:400%}50%{transform:rotate(-10deg);font-size:450%}}@keyframes shutter{0%{margin-left:.5em;transform:skewX(5deg,5deg)}50%{margin-left:-.5em;transform:skew(-5deg,-5deg)}}@keyframes hint{to{font-size:500%;opacity:0}}@media (max-width:767px){.game-tile[_ngcontent-%COMP%]{height:6em;width:6em}.game-tile[_ngcontent-%COMP%]   .tile-overlay[_ngcontent-%COMP%]{font-size:3.35em}}"]}),e})();function H(e,t){if(1&e&&n.Mb(0,"app-game-board-tile",5),2&e){const e=t.$implicit,i=n.Zb(2);n.fc("tile",e)("disabled",i.boardDisabled)}}function q(e,t){if(1&e&&(n.Ob(0,"div"),n.Ob(1,"div",3),n.pc(2,H,1,2,"app-game-board-tile",4),n.Nb(),n.Nb()),2&e){const e=t.$implicit;n.Bb(2),n.fc("ngForOf",e)}}let $=(()=>{class e{constructor(e,t,i,a,r){this.gameService=e,this.gameLoopService=t,this.tileRemoveService=i,this.gameInteractionsService=a,this.audioService=r,this.boardDisabled=!1,this.score=0,this.level=1,this.matchSetCount=0,this.matchProgress=0,this.matchSets=[],this.currentMatchSet=[],this.potentialMatchSets=[],this.GAME_BOARD_ROWS=7,this.GAME_BOARD_COLUMNS=5,this.MATCH_SET_COUNT_NEXT_LEVEL=10,this.AUTHORED_LEVEL_COUNT=3,this.subscription=new s.a,this.swapInProgress=!1,this.scoreUpdated=new n.n,this.levelUpdated=new n.n}ngOnInit(){this.gameLoopService.gameLoopState$.pipe(b(50)).pipe(Object(S.a)(this.subscription)).subscribe(e=>{switch(e){case y.LockBoard:this.boardDisabled=!0,this.gameLoopService.DoStep(y.FindMatches);break;case y.FindMatches:this.gameService.FindMatchesAndPotentials(this.gameBoard),this.matchSets=this.gameService.currentMatchSets,this.potentialMatchSets=this.gameService.currentPotentialMatches,this.gameLoopService.DoStep(y.RemoveMatchSet);break;case y.RemoveMatchSet:this.matchSets.length?(this.currentMatchSet=this.matchSets.shift(),this.tileRemoveService.StartTileDeletion(this.currentMatchSet.map(e=>Object.assign({},e))),this.matchSetCount++,this.swapInProgress=!1,this.audioService.PlayAudio(_.b.MatchFound)):(this.swapInProgress&&(this.gameInteractionsService.DoStep(m.SwapBack),this.swapInProgress=!1),this.potentialMatchSets.length&&this.gameLoopService.DoStep(y.UnlockBoard));break;case y.ApplyScoring:this.gameService.ApplyScoring(this.gameBoard,this.currentMatchSet,this.level),this.score+=this.gameService.TallyScore(this.gameBoard),this.scoreUpdated.emit(this.score),this.matchProgress=this.matchSetCount/this.MATCH_SET_COUNT_NEXT_LEVEL*100,this.matchSetCount>=this.MATCH_SET_COUNT_NEXT_LEVEL?this.nextLevel():this.gameLoopService.DoStep(y.FindMatches);break;case y.UnlockBoard:this.boardDisabled=!1}}),this.tileRemoveService.tileRemoveState$.pipe(b(100)).pipe(Object(S.a)(this.subscription)).subscribe(e=>{switch(e){case I.SetToRemove:this.tileRemoveService.SetToRemove(this.gameBoard);break;case I.NextTile:this.gameService.ReIndexGrid(this.gameBoard),this.tileRemoveService.NextTile(this.gameService.NewTile(0,0,this.levelToRender()));break;case I.ApplyRemoveClass:this.tileRemoveService.ApplyRemoveClass(this.gameBoard);break;case I.ApplyDropClass:this.tileRemoveService.ApplyDropClass(this.gameBoard);break;case I.Shift:this.tileRemoveService.Shift(this.gameBoard);break;case I.Complete:this.gameLoopService.DoStep(y.ApplyScoring)}}),this.gameInteractionsService.gameInteractionState$.pipe(b(100)).pipe(Object(S.a)(this.subscription)).subscribe(e=>{switch(e){case m.LocateAdjacentTile:this.gameInteractionsService.LocateAdjacentTile(this.gameBoard)&&(this.swapInProgress=!0,this.audioService.PlayAudio(_.b.Swipe),this.gameInteractionsService.DoStep(m.ApplyDirectionalAnimation));break;case m.ApplyDirectionalAnimation:this.gameInteractionsService.SetDirectionalAnimationClass(this.gameBoard);break;case m.Swap:this.gameInteractionsService.Swap(this.gameBoard),this.gameService.ReIndexGrid(this.gameBoard),this.gameLoopService.DoStep(y.LockBoard);break;case m.SwapBack:this.gameInteractionsService.SwapBack();break;case m.Shutter:this.gameInteractionsService.Shutter(this.gameBoard),this.audioService.PlayAudio(_.b.InvalidSwipe);break;case m.ShowHint:this.audioService.PlayAudio(_.b.Hint),this.gameInteractionsService.ApplyPotentials(this.gameBoard,this.potentialMatchSets,!0)}}),this.NewGame()}ngOnDestroy(){this.subscription.next(!0),this.subscription.complete()}NewGame(e=!1){e||(this.score=0,this.scoreUpdated.emit(this.score),this.level=1,this.levelUpdated.emit(this.level)),this.matchProgress=0,this.gameBoard=this.gameService.CreateGame(this.GAME_BOARD_ROWS,this.GAME_BOARD_COLUMNS,this.levelToRender()),this.gameLoopService.DoStep(y.LockBoard),this.audioService.PlayAudio(_.b.LevelChange)}Hint(){this.gameInteractionsService.DoStep(m.ShowHint);const e=25*this.level;this.score-e>Number.MIN_SAFE_INTEGER&&(this.score-=e,this.scoreUpdated.emit(this.score))}nextLevel(){this.matchSetCount=0,this.level++,this.levelUpdated.emit(this.level),this.NewGame(!0)}levelToRender(){const e=this.level%this.AUTHORED_LEVEL_COUNT;return 0===e?3:e}}return e.\u0275fac=function(t){return new(t||e)(n.Lb(A),n.Lb(w),n.Lb(M),n.Lb(d),n.Lb(x.a))},e.\u0275cmp=n.Fb({type:e,selectors:[["app-game-board"]],outputs:{scoreUpdated:"scoreUpdated",levelUpdated:"levelUpdated"},decls:3,vars:2,consts:[[1,"game-board"],[4,"ngFor","ngForOf"],["mode","determinate",3,"value"],[1,"grid-column"],[3,"tile","disabled",4,"ngFor","ngForOf"],[3,"tile","disabled"]],template:function(e,t){1&e&&(n.Ob(0,"div",0),n.pc(1,q,3,1,"div",1),n.Mb(2,"mat-progress-bar",2),n.Nb()),2&e&&(n.Bb(1),n.fc("ngForOf",t.gameBoard.grid),n.Bb(1),n.fc("value",t.matchProgress))},directives:[a.k,V,z],styles:[".game-board[_ngcontent-%COMP%]{display:inline-block;position:relative;overflow:hidden}.game-board[_ngcontent-%COMP%]   .grid-column[_ngcontent-%COMP%]{display:flex}"]}),e})();const Z=[{path:"",component:(()=>{class e{constructor(){this.score=0,this.level=1}ngOnInit(){}updateScore(e){this.score=e}updateLevel(e){this.level=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=n.Fb({type:e,selectors:[["app-game-container"]],decls:14,vars:8,consts:[[1,"game-container"],[1,"game-header"],[1,"game-controls"],["mat-raised-button","","color","accent",3,"disabled","click"],[1,"game-board",3,"scoreUpdated","levelUpdated"],["gameBoard",""]],template:function(e,t){if(1&e){const e=n.Pb();n.Ob(0,"div",0),n.Ob(1,"div",1),n.Ob(2,"h2"),n.rc(3),n.Nb(),n.Ob(4,"h2"),n.rc(5),n.ac(6,"number"),n.Nb(),n.Ob(7,"div",2),n.Ob(8,"button",3),n.Vb("click",function(){return n.jc(e),n.hc(13).Hint()}),n.rc(9," Hint "),n.Nb(),n.Ob(10,"button",3),n.Vb("click",function(){return n.jc(e),n.hc(13).NewGame()}),n.rc(11," New Game "),n.Nb(),n.Nb(),n.Nb(),n.Ob(12,"app-game-board",4,5),n.Vb("scoreUpdated",function(e){return t.updateScore(e)})("levelUpdated",function(e){return t.updateLevel(e)}),n.Nb(),n.Nb()}if(2&e){const e=n.hc(13);n.Bb(3),n.tc("Level ",t.level,""),n.Bb(2),n.tc("Score: ",n.cc(6,4,t.score,"1.0","en-US"),""),n.Bb(3),n.fc("disabled",e.boardDisabled),n.Bb(2),n.fc("disabled",e.boardDisabled)}},directives:[o.a,$],pipes:[a.e],styles:[".game-container[_ngcontent-%COMP%]   .game-header[_ngcontent-%COMP%]{display:flex;justify-content:space-evenly}.game-container[_ngcontent-%COMP%]   .game-header[_ngcontent-%COMP%]   .game-controls[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:.5em}"]}),e})()}];let J=(()=>{class e{}return e.\u0275mod=n.Jb({type:e}),e.\u0275inj=n.Ib({factory:function(t){return new(t||e)},imports:[[a.c,r.c.forChild(Z)]]}),e})(),Y=(()=>{class e{}return e.\u0275mod=n.Jb({type:e}),e.\u0275inj=n.Ib({factory:function(t){return new(t||e)},imports:[[a.c,J,o.b,X]]}),e})()}}]);