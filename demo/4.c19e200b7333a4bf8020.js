(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{vTnf:function(e,t,i){"use strict";i.r(t),i.d(t,"GameModule",function(){return q});var n=i("ofXK"),r=i("tyNb"),s=i("fXoL"),a=i("XNiG");let o=(()=>{class e{WithinGrid(e,t,i){var n,r;const s=null===(n=null==i?void 0:i.grid)||void 0===n?void 0:n.length,a=null===(r=null==i?void 0:i.grid[0])||void 0===r?void 0:r.length;return e>-1&&t>-1&&e<s&&t<a}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.zb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var c=function(e){return e[e.Left=2]="Left",e[e.Right=4]="Right",e[e.Up=8]="Up",e[e.Down=16]="Down",e}({}),l=function(e){return e[e.LocateAdjacentTile=0]="LocateAdjacentTile",e[e.ApplyDirectionalAnimation=1]="ApplyDirectionalAnimation",e[e.Swap=2]="Swap",e[e.SwapBack=3]="SwapBack",e[e.Shutter=4]="Shutter",e}({});let h=(()=>{class e{constructor(e){this.gameUtilityService=e,this.gameInteractionStateSource=new a.a,this.gameInteractionState$=this.gameInteractionStateSource.asObservable(),this.isSwapBack=!1}DoStep(e){this.gameInteractionStateSource.next(e)}TileSwiped(e){this.playerTile=e,this.adjacentTile={},this.gameInteractionStateSource.next(l.LocateAdjacentTile)}LocateAdjacentTile(e){let t=this.playerTile.tile.rowInx,i=this.playerTile.tile.colInx;if(1!==this.playerTile.direction){switch(this.playerTile.direction){case c.Up:t--;break;case c.Right:i++;break;case c.Down:t++;break;case c.Left:i--}if(this.gameUtilityService.WithinGrid(t,i,e))return this.adjacentTile=e.grid[t][i],!0}return e.grid[this.playerTile.tile.rowInx][this.playerTile.tile.colInx].animateShutter=!1,this.gameInteractionStateSource.next(l.Shutter),!1}SetDirectionalAnimationClass(e){switch(this.playerTile.direction){case c.Up:e.grid[this.playerTile.tile.rowInx][this.playerTile.tile.colInx].animateSlideUp=!0,e.grid[this.adjacentTile.rowInx][this.adjacentTile.colInx].animateSlideDown=!0;break;case c.Right:e.grid[this.playerTile.tile.rowInx][this.playerTile.tile.colInx].animateSlideRight=!0,e.grid[this.adjacentTile.rowInx][this.adjacentTile.colInx].animateSlideLeft=!0;break;case c.Down:e.grid[this.playerTile.tile.rowInx][this.playerTile.tile.colInx].animateSlideDown=!0,e.grid[this.adjacentTile.rowInx][this.adjacentTile.colInx].animateSlideUp=!0;break;case c.Left:e.grid[this.playerTile.tile.rowInx][this.playerTile.tile.colInx].animateSlideLeft=!0,e.grid[this.adjacentTile.rowInx][this.adjacentTile.colInx].animateSlideRight=!0}this.gameInteractionStateSource.next(l.Swap)}Swap(e){const t=Object.assign({},e.grid[this.playerTile.tile.rowInx][this.playerTile.tile.colInx]),i=Object.assign({},e.grid[this.adjacentTile.rowInx][this.adjacentTile.colInx]);e.grid[this.playerTile.tile.rowInx][this.playerTile.tile.colInx]=i,e.grid[this.adjacentTile.rowInx][this.adjacentTile.colInx]=t}SwapBack(){this.isSwapBack=!this.isSwapBack,this.isSwapBack&&this.gameInteractionStateSource.next(l.LocateAdjacentTile)}Shutter(e){e.grid[this.playerTile.tile.rowInx][this.playerTile.tile.colInx].animateShutter=!0}}return e.\u0275fac=function(t){return new(t||e)(s.Jb(o))},e.\u0275prov=s.zb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var d=i("quSY");class u extends d.a{constructor(e,t){super()}schedule(e,t=0){return this}}class g extends u{constructor(e,t){super(e,t),this.scheduler=e,this.work=t,this.pending=!1}schedule(e,t=0){if(this.closed)return this;this.state=e;const i=this.id,n=this.scheduler;return null!=i&&(this.id=this.recycleAsyncId(n,i,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(n,this.id,t),this}requestAsyncId(e,t,i=0){return setInterval(e.flush.bind(e,this),i)}recycleAsyncId(e,t,i=0){if(null!==i&&this.delay===i&&!1===this.pending)return t;clearInterval(t)}execute(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(e,t);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,t){let i=!1,n=void 0;try{this.work(e)}catch(r){i=!0,n=!!r&&r||new Error(r)}if(i)return this.unsubscribe(),n}_unsubscribe(){const e=this.id,t=this.scheduler,i=t.actions,n=i.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==n&&i.splice(n,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}let p=(()=>{class e{constructor(t,i=e.now){this.SchedulerAction=t,this.now=i}schedule(e,t=0,i){return new this.SchedulerAction(this,e).schedule(i,t)}}return e.now=()=>Date.now(),e})();class m extends p{constructor(e,t=p.now){super(e,()=>m.delegate&&m.delegate!==this?m.delegate.now():t()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(e,t=0,i){return m.delegate&&m.delegate!==this?m.delegate.schedule(e,t,i):super.schedule(e,t,i)}flush(e){const{actions:t}=this;if(this.active)return void t.push(e);let i;this.active=!0;do{if(i=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,i){for(;e=t.shift();)e.unsubscribe();throw i}}}const S=new m(g);var b=i("7o/Q"),v=i("EY2u"),f=i("LRne"),w=i("HDdC");let x=(()=>{class e{constructor(e,t,i){this.kind=e,this.value=t,this.error=i,this.hasValue="N"===e}observe(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}do(e,t,i){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return i&&i()}}accept(e,t,i){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,i)}toObservable(){switch(this.kind){case"N":return Object(f.a)(this.value);case"E":return e=this.error,new w.a(t=>t.error(e));case"C":return Object(v.b)()}var e;throw new Error("unexpected notification kind value")}static createNext(t){return void 0!==t?new e("N",t):e.undefinedValueNotification}static createError(t){return new e("E",void 0,t)}static createComplete(){return e.completeNotification}}return e.completeNotification=new e("C"),e.undefinedValueNotification=new e("N",void 0),e})();function y(e,t=S){var i;const n=(i=e)instanceof Date&&!isNaN(+i)?+e-t.now():Math.abs(e);return e=>e.lift(new I(n,t))}class I{constructor(e,t){this.delay=e,this.scheduler=t}call(e,t){return t.subscribe(new M(e,this.delay,this.scheduler))}}class M extends b.a{constructor(e,t,i){super(e),this.delay=t,this.scheduler=i,this.queue=[],this.active=!1,this.errored=!1}static dispatch(e){const t=e.source,i=t.queue,n=e.scheduler,r=e.destination;for(;i.length>0&&i[0].time-n.now()<=0;)i.shift().notification.observe(r);if(i.length>0){const t=Math.max(0,i[0].time-n.now());this.schedule(e,t)}else this.unsubscribe(),t.active=!1}_schedule(e){this.active=!0,this.destination.add(e.schedule(M.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))}scheduleNotification(e){if(!0===this.errored)return;const t=this.scheduler,i=new _(t.now()+this.delay,e);this.queue.push(i),!1===this.active&&this._schedule(t)}_next(e){this.scheduleNotification(x.createNext(e))}_error(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()}_complete(){this.scheduleNotification(x.createComplete()),this.unsubscribe()}}class _{constructor(e,t){this.time=e,this.notification=t}}var T=i("zx2A");function k(e){return t=>t.lift(new C(e))}class C{constructor(e){this.notifier=e}call(e,t){const i=new R(e),n=Object(T.c)(this.notifier,new T.a(i));return n&&!i.seenValue?(i.add(n),t.subscribe(i)):i}}class R extends T.b{constructor(e){super(e),this.seenValue=!1}notifyNext(){this.seenValue=!0,this.complete()}notifyComplete(){}}var O=function(e){return e[e.LockBoard=0]="LockBoard",e[e.FindMatches=1]="FindMatches",e[e.RemoveMatchSet=2]="RemoveMatchSet",e[e.ApplyScoring=3]="ApplyScoring",e[e.UnlockBoard=4]="UnlockBoard",e}({});let A=(()=>{class e{constructor(){this.gameLoopStateSource=new a.a,this.gameLoopState$=this.gameLoopStateSource.asObservable()}DoStep(e){this.gameLoopStateSource.next(e)}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.zb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var E=function(e){return e[e.SetToRemove=0]="SetToRemove",e[e.NextTile=1]="NextTile",e[e.ApplyRemoveClass=2]="ApplyRemoveClass",e[e.ApplyDropClass=3]="ApplyDropClass",e[e.Shift=4]="Shift",e[e.Complete=5]="Complete",e}({});let D=(()=>{class e{constructor(){this.tileRemoveStateSource=new a.a,this.tilesToRemove=[],this.tileRemoveState$=this.tileRemoveStateSource.asObservable()}StartTileDeletion(e){this.tilesToRemove=e,this.tileRemoveStateSource.next(E.SetToRemove)}SetToRemove(e){this.tilesToRemove.forEach(t=>{e.grid[t.rowInx][t.colInx].toRemove=!0}),this.tileRemoveStateSource.next(E.NextTile)}NextTile(e){this.tilesToRemove.length?(this.currentTile=this.tilesToRemove.shift(),e.colInx=this.currentTile.colInx,this.newTile=e,this.tileRemoveStateSource.next(E.ApplyRemoveClass)):this.tileRemoveStateSource.next(E.Complete)}ApplyRemoveClass(e){e.grid[this.currentTile.rowInx][this.currentTile.colInx].animateRemove=!0,this.tileRemoveStateSource.next(E.ApplyDropClass)}ApplyDropClass(e){let t=this.currentTile.rowInx;for(;t>0;)t--,e.grid[t][this.currentTile.colInx].animateSlideDown=!0;this.tileRemoveStateSource.next(E.Shift)}Shift(e){let t=this.currentTile.rowInx;const i=this.currentTile.colInx;for(;t>0;){t--;const n=Object.assign({},e.grid[t][i]);n.rowInx=t+1,n.animateSlideDown=!1,e.grid[t+1][i]=n}e.grid[0][i]=this.newTile,this.tileRemoveStateSource.next(E.NextTile)}debugColumn(e,t){for(let i=0;i<t.grid.length;i++)console.log("    ",i,t.grid[i][e])}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=s.zb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();const P={icons:[{code:"1F60E",version:"E1.0",title:"smiling face with sunglasses"},{code:"1F63A",version:"E0.6",title:"grinning cat"},{code:"1F43A",version:"E0.6",title:"wolf"},{code:"1F42C",version:"E0.6",title:"dolphin"},{code:"1F3E1",version:"E0.6",title:"house with garden"},{code:"1F9C7",version:"E12.0",title:"waffle"}]};var N=function(e){return e[e.N=0]="N",e[e.NE=1]="NE",e[e.E=2]="E",e[e.SE=3]="SE",e[e.S=4]="S",e[e.SW=5]="SW",e[e.W=6]="W",e[e.NW=7]="NW",e}({});const B=[N.N,N.E,N.S,N.W],L=[N.N,N.NE,N.E,N.SE,N.S,N.SW,N.W,N.NW];let j=(()=>{class e{constructor(e){this.gameUtilityService=e,this.candidateMatches=new Array,this.matchSets=[],this.potentialMatchSets=[]}get currentMatchSets(){return this.matchSets}get currentPotentialMatches(){return this.potentialMatchSets}CreateGame(e,t){const i={grid:[]};for(let n=0;n<e;n++){i.grid[n]=new Array;for(let e=0;e<t;e++){const t=this.NewTile(n,e);i.grid[n][e]=t}}return i}NewTile(e,t){const i=P.icons[Math.floor(Math.random()*P.icons.length)];return Object.assign({colInx:t,rowInx:e,html:`&#x${i.code};`,score:0},i)}ReIndexGrid(e){var t;null===(t=null==e?void 0:e.grid)||void 0===t||t.forEach((t,i)=>{t.forEach((t,n)=>{e.grid[i][n].colInx=n,e.grid[i][n].rowInx=i,e.grid[i][n].matched=!1,e.grid[i][n].potential=!1,e.grid[i][n].score=0,e.grid[i][n].animateSlideUp=!1,e.grid[i][n].animateSlideRight=!1,e.grid[i][n].animateSlideDown=!1,e.grid[i][n].animateSlideLeft=!1,e.grid[i][n].animateShutter=!1})})}ApplyScoring(e,t){for(const i of t){const n=e.grid[i.rowInx][i.colInx].score;e.grid[i.rowInx][i.colInx].score=n?n*t.length:t.length}}TallyScore(e){let t=0;return null==e||e.grid.forEach(e=>e.forEach(e=>{t+=e.score})),t}ApplyPotentials(e,t){if(e&&t)for(const i of t)for(const t of i)e.grid[t.rowInx][t.colInx].potential=!0}FindMatchesAndPotentials(e){var t;this.candidateMatches=[],this.matchSets=[],this.potentialMatchSets=[],null===(t=null==e?void 0:e.grid)||void 0===t||t.forEach(t=>{t.forEach(t=>{B.forEach(i=>{this.candidateMatches=[Object.assign({},t)],this.directionalSearch(i,t,e),this.candidateMatches.length>=3&&(this.candidateMatches.forEach(t=>{e.grid[t.rowInx][t.colInx].matched=!0}),this.candidateMatches.every(e=>e.matched)||this.matchSets.push([...this.candidateMatches]))}),this.potentialSearchStaggered(t,e)})})}directionalSearch(e,t,i){let n=t.rowInx,r=t.colInx;switch(e){case N.N:n=t.rowInx-1;break;case N.E:r=t.colInx+1;break;case N.S:n=t.rowInx+1;break;case N.W:r=t.colInx-1}if(!this.gameUtilityService.WithinGrid(n,r,i))return;const s=i.grid[n][r];if(s.code===t.code)this.candidateMatches.push(Object.assign({},s)),this.directionalSearch(e,s,i);else if(2===this.candidateMatches.length)return this.potentialSearch(t,i),void this.potentialExtended(e,t,i)}potentialSearch(e,t){let i=0,n=0;for(const r of L){switch(r){case N.N:i=e.rowInx-1;break;case N.NE:i=e.rowInx-1,n=e.colInx+1;break;case N.E:n=e.colInx+1;break;case N.SE:i=e.rowInx+1,n=e.colInx+1;break;case N.S:i=e.rowInx+1;break;case N.SW:i=e.rowInx+1,n=e.colInx-1;break;case N.W:n=e.colInx-1;break;case N.NW:i=e.rowInx-1,n=e.colInx-1}if(this.gameUtilityService.WithinGrid(i,n,t)){const r=t.grid[i][n],s=this.candidateMatches[0];if(r&&r.rowInx!==s.rowInx&&r.colInx!==s.colInx&&r.code===e.code)return void this.potentialMatchSets.push([...this.candidateMatches,r])}}}potentialExtended(e,t,i){let n=t.rowInx,r=t.colInx;switch(e){case N.N:n=t.rowInx-2;break;case N.E:r=t.colInx+2;break;case N.S:n=t.rowInx+2;break;case N.W:r=t.colInx-2}if(this.gameUtilityService.WithinGrid(n,r,i)){const e=i.grid[n][r];this.candidateMatches.every(t=>t.code===e.code)&&this.potentialMatchSets.push([...this.candidateMatches,e])}}potentialSearchStaggered(e,t){var i;const n=new Array;let r=0,s=0;if(B.forEach(i=>{switch(r=e.rowInx,s=e.colInx,i){case N.N:r=e.rowInx-1;break;case N.E:s=e.colInx+1;break;case N.S:r=e.rowInx+1;break;case N.W:s=e.colInx-1}this.gameUtilityService.WithinGrid(r,s,t)&&n.push(t.grid[r][s])}),n.length>=3)for(let a=0;a<n.length;a++){const e=null===(i=n[a])||void 0===i?void 0:i.code,t=n.filter(t=>(null==t?void 0:t.code)===e);if(t.length>=3)return void this.potentialMatchSets.push(t)}}}return e.\u0275fac=function(t){return new(t||e)(s.Jb(o))},e.\u0275prov=s.zb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),F=(()=>{class e{constructor(e){this.gameInteractionsService=e}onSwipe(e){this.gameInteractionsService.TileSwiped({tile:this.tile,direction:null==e?void 0:e.direction})}}return e.\u0275fac=function(t){return new(t||e)(s.Db(h))},e.\u0275cmp=s.xb({type:e,selectors:[["app-game-board-tile"]],inputs:{tile:"tile",disabled:"disabled"},decls:3,vars:19,consts:[[1,"game-tile",3,"swipe"],[1,"tile-overlay",3,"innerHTML"],[1,"emoji"]],template:function(e,t){1&e&&(s.Gb(0,"div",0),s.Mb("swipe",function(e){return t.onSwipe(e)}),s.Eb(1,"div",1),s.Eb(2,"div",2),s.Fb()),2&e&&(s.vb("game-tile__disabled",t.disabled),s.tb(1),s.vb("tile-overlay__to-remove",null==t.tile?null:t.tile.toRemove)("tile-overlay__remove",null==t.tile?null:t.tile.animateRemove)("tile-overlay__slide-up",null==t.tile?null:t.tile.animateSlideUp)("tile-overlay__slide-right",null==t.tile?null:t.tile.animateSlideRight)("tile-overlay__slide-down",null==t.tile?null:t.tile.animateSlideDown)("tile-overlay__slide-left",null==t.tile?null:t.tile.animateSlideLeft)("tile-overlay__reset-slide",!(null!=t.tile&&t.tile.animateSlideDown||null!=t.tile&&t.tile.animateSlideUp||null!=t.tile&&t.tile.animateSlideRight||t.tile.animateSlideLeft))("tile-overlay__shutter",null==t.tile?null:t.tile.animateShutter),s.Pb("innerHTML",null==t.tile?null:t.tile.html,s.Rb))},styles:[".game-tile[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;position:relative;height:1.5em;width:1.5em;font-size:4em;background-color:#d3d3d3;border-radius:.25em;margin:.1em;display:flex;justify-content:center;align-items:center;transition:opacity .5s}.game-tile__disabled[_ngcontent-%COMP%]{filter:blur(1px)}.game-tile[_ngcontent-%COMP%]   .emoji[_ngcontent-%COMP%]{box-sizing:border-box;top:0;left:0;right:0;bottom:0;visibility:hidden}.game-tile[_ngcontent-%COMP%]   .tile-overlay[_ngcontent-%COMP%]{position:absolute;transition:transform 1s,font-size 1s,opacity 1s,margin-left .5s,margin-top .5s}.game-tile[_ngcontent-%COMP%]   .tile-overlay__slide-down[_ngcontent-%COMP%]{margin-top:3.3em;z-index:1;filter:blur(2px)}.game-tile[_ngcontent-%COMP%]   .tile-overlay__slide-up[_ngcontent-%COMP%]{margin-top:-3.3em;z-index:1;filter:blur(2px)}.game-tile[_ngcontent-%COMP%]   .tile-overlay__slide-right[_ngcontent-%COMP%]{margin-left:3.3em;z-index:1;filter:blur(2px)}.game-tile[_ngcontent-%COMP%]   .tile-overlay__slide-left[_ngcontent-%COMP%]{margin-left:-3.3em;z-index:1;filter:blur(2px)}.game-tile[_ngcontent-%COMP%]   .tile-overlay__reset-slide[_ngcontent-%COMP%]{transition:transform 1s,font-size 1s,opacity 1s;margin-left:0;margin-top:0}.game-tile[_ngcontent-%COMP%]   .tile-overlay__to-remove[_ngcontent-%COMP%]{animation:wobble 1s infinite}.game-tile[_ngcontent-%COMP%]   .tile-overlay__remove[_ngcontent-%COMP%]{transform:rotate(-365deg);font-size:0;opacity:0}.game-tile[_ngcontent-%COMP%]   .tile-overlay__shutter[_ngcontent-%COMP%]{animation:shutter .25s 2}@keyframes wobble{0%{transform:rotate(10deg);font-size:90%}50%{transform:rotate(-10deg);font-size:120%}}@keyframes shutter{0%{margin-left:.5em;transform:skewX(5deg,5deg)}50%{margin-left:-.5em;transform:skew(-5deg,-5deg)}}"]}),e})();function U(e,t){if(1&e&&s.Eb(0,"app-game-board-tile",2),2&e){const e=t.$implicit,i=s.Ob();s.Pb("tile",e)("disabled",i.disabled)}}let G=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.xb({type:e,selectors:[["app-game-board-row"]],inputs:{tileRow:"tileRow",disabled:"disabled"},decls:2,vars:1,consts:[[1,"game-row"],["class","game-row",3,"tile","disabled",4,"ngFor","ngForOf"],[1,"game-row",3,"tile","disabled"]],template:function(e,t){1&e&&(s.Gb(0,"div",0),s.Ub(1,U,1,2,"app-game-board-tile",1),s.Fb()),2&e&&(s.tb(1),s.Pb("ngForOf",t.tileRow))},directives:[n.h,F],styles:[".game-row[_ngcontent-%COMP%]{display:flex}"]}),e})();function W(e,t){if(1&e&&(s.Gb(0,"div"),s.Eb(1,"app-game-board-row",2),s.Fb()),2&e){const e=t.$implicit,i=s.Ob();s.tb(1),s.Pb("tileRow",e)("disabled",i.boardDisabled)}}let z=(()=>{class e{constructor(e,t,i,n){this.gameService=e,this.gameLoopService=t,this.tileRemoveService=i,this.gameInteractionsService=n,this.score=0,this.boardDisabled=!1,this.matchSets=[],this.currentMatchSet=[],this.potentialMatchSets=[],this.scoreUpdated=new s.n,this.GAME_BOARD_ROWS=7,this.GAME_BOARD_COLUMNS=5,this.subscription=new a.a,this.swapInProgress=!1,this.gameBoard=this.gameService.CreateGame(this.GAME_BOARD_ROWS,this.GAME_BOARD_COLUMNS),console.log("created",this.gameBoard)}ngOnInit(){this.gameLoopService.gameLoopState$.pipe(y(50)).pipe(k(this.subscription)).subscribe(e=>{switch(e){case O.LockBoard:this.boardDisabled=!0,this.gameLoopService.DoStep(O.FindMatches);break;case O.FindMatches:this.gameService.FindMatchesAndPotentials(this.gameBoard),this.matchSets=this.gameService.currentMatchSets,this.potentialMatchSets=this.gameService.currentPotentialMatches,this.gameLoopService.DoStep(O.RemoveMatchSet);break;case O.RemoveMatchSet:this.matchSets.length?(this.currentMatchSet=this.matchSets.shift(),this.tileRemoveService.StartTileDeletion(this.currentMatchSet.map(e=>Object.assign({},e))),this.swapInProgress=!1):(this.swapInProgress&&(this.gameInteractionsService.DoStep(l.SwapBack),this.swapInProgress=!1),this.potentialMatchSets.length&&this.gameLoopService.DoStep(O.UnlockBoard));break;case O.ApplyScoring:this.gameService.ApplyScoring(this.gameBoard,this.currentMatchSet),this.score+=this.gameService.TallyScore(this.gameBoard),this.scoreUpdated.emit(this.score),this.gameLoopService.DoStep(O.FindMatches);break;case O.UnlockBoard:this.boardDisabled=!1}}),this.tileRemoveService.tileRemoveState$.pipe(y(150)).pipe(k(this.subscription)).subscribe(e=>{switch(e){case E.SetToRemove:this.tileRemoveService.SetToRemove(this.gameBoard);break;case E.NextTile:this.gameService.ReIndexGrid(this.gameBoard),this.tileRemoveService.NextTile(this.gameService.NewTile(0,0));break;case E.ApplyRemoveClass:this.tileRemoveService.ApplyRemoveClass(this.gameBoard);break;case E.ApplyDropClass:this.tileRemoveService.ApplyDropClass(this.gameBoard);break;case E.Shift:this.tileRemoveService.Shift(this.gameBoard);break;case E.Complete:this.gameLoopService.DoStep(O.ApplyScoring)}}),this.gameInteractionsService.gameInteractionState$.pipe(y(100)).pipe(k(this.subscription)).subscribe(e=>{switch(e){case l.LocateAdjacentTile:this.gameInteractionsService.LocateAdjacentTile(this.gameBoard)&&(this.swapInProgress=!0,this.gameInteractionsService.DoStep(l.ApplyDirectionalAnimation));break;case l.ApplyDirectionalAnimation:this.gameInteractionsService.SetDirectionalAnimationClass(this.gameBoard);break;case l.Swap:this.gameInteractionsService.Swap(this.gameBoard),this.gameService.ReIndexGrid(this.gameBoard),this.gameLoopService.DoStep(O.LockBoard);break;case l.SwapBack:this.gameInteractionsService.SwapBack();break;case l.Shutter:this.gameInteractionsService.Shutter(this.gameBoard)}}),this.gameLoopService.DoStep(O.LockBoard)}ngOnDestroy(){this.subscription.next(!0),this.subscription.complete()}}return e.\u0275fac=function(t){return new(t||e)(s.Db(j),s.Db(A),s.Db(D),s.Db(h))},e.\u0275cmp=s.xb({type:e,selectors:[["app-game-board"]],outputs:{scoreUpdated:"scoreUpdated"},decls:2,vars:1,consts:[[1,"game-board"],[4,"ngFor","ngForOf"],[3,"tileRow","disabled"]],template:function(e,t){1&e&&(s.Gb(0,"div",0),s.Ub(1,W,2,2,"div",1),s.Fb()),2&e&&(s.tb(1),s.Pb("ngForOf",t.gameBoard.grid))},directives:[n.h,G],styles:[".game-board[_ngcontent-%COMP%]{display:inline-block;position:relative;overflow:hidden}"]}),e})();const V=[{path:"",component:(()=>{class e{ngOnInit(){}updateScore(e){this.score=e}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=s.xb({type:e,selectors:[["app-game-container"]],decls:10,vars:1,consts:[[1,"game-container"],[1,"header"],[1,"game-title"],[1,"game-board",3,"scoreUpdated"],[1,"controls"],[1,"footer"]],template:function(e,t){1&e&&(s.Gb(0,"div",0),s.Gb(1,"div",1),s.Gb(2,"h1",2),s.Vb(3,"Emoji Swap!"),s.Fb(),s.Fb(),s.Gb(4,"app-game-board",3),s.Mb("scoreUpdated",function(e){return t.updateScore(e)}),s.Fb(),s.Gb(5,"div",4),s.Gb(6,"h2"),s.Vb(7),s.Fb(),s.Fb(),s.Gb(8,"div",5),s.Vb(9,"This was fun to make!"),s.Fb(),s.Fb()),2&e&&(s.tb(7),s.Wb("Score: ",t.score,""))},directives:[z],styles:[".game-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:auto;grid-template-rows:5em auto 5em 5em}.game-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]{justify-self:center;align-self:center}.game-container[_ngcontent-%COMP%]   .header[_ngcontent-%COMP%]   .game-title[_ngcontent-%COMP%]{font-weight:700}.game-container[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%], .game-container[_ngcontent-%COMP%]   .footer[_ngcontent-%COMP%], .game-container[_ngcontent-%COMP%]   .game-board[_ngcontent-%COMP%]{justify-self:center;align-self:center}"]}),e})()}];let $=(()=>{class e{}return e.\u0275mod=s.Bb({type:e}),e.\u0275inj=s.Ab({factory:function(t){return new(t||e)},imports:[[n.b,r.a.forChild(V)]]}),e})(),q=(()=>{class e{}return e.\u0275mod=s.Bb({type:e}),e.\u0275inj=s.Ab({factory:function(t){return new(t||e)},imports:[[n.b,$]]}),e})()}}]);